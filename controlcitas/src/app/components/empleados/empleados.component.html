<div class="container">
    <div>
        <ngb-alert id="uno" type="success" (close)="cerrar('uno')">{{strings.alert16}}</ngb-alert>
        <ngb-alert id="kinto" type="danger" (close)="cerrar('kinto')">{{strings.alert}}</ngb-alert>
        <ngb-alert id="dos" type="danger" (close)="cerrar('dos')">{{strings.alert17}}</ngb-alert>
        <ngb-alert id="seis" type="warning" (close)="cerrar('seis')">{{strings.alert12}}</ngb-alert>
        <ngb-alert id="ceis" type="warning" (close)="cerrar('ceis')">{{strings.alert12}}</ngb-alert>
        <ngb-alert id="tres" type="warning" (close)="cerrar('tres')">{{strings.alert18}}</ngb-alert>
    </div>
    <div class="forms">
        <form [formGroup]="employeeForm" (ngSubmit)="editEmployee(employeeForm.value)"
            class="col bg-light shadow-sm p-3 mb-5 rounded border">
            <h5 class="text-center">{{strings.edit_employee}}</h5><br>
            <div class="row">
                <div class="col">
                    <label>{{strings.name}}<p>*</p></label>
                    <input type="text" id="nombre" class="form-control" maxlength="30" formControlName="nombre"
                        [(ngModel)]="employee.nombre">
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.nombre">
                            <div *ngIf="employeeForm.get('nombre').hasError(validation.type) &&
                              (employeeForm.get('nombre').dirty || employeeForm.get('nombre').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <label>{{strings.surname1}}<p>*</p></label>
                    <input type="text" id="apellido_paterno" class="form-control" formControlName="apellido_paterno"
                        [(ngModel)]="employee.apellido_paterno" maxlength="30">
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.apellido_paterno">
                            <div
                                *ngIf="employeeForm.get('apellido_paterno').hasError(validation.type) &&
                              (employeeForm.get('apellido_paterno').dirty || employeeForm.get('apellido_paterno').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div class="col">
                    <label>{{strings.surname2}}<p>*</p></label>
                    <input type="text" id="apellido_materno" class="form-control" formControlName="apellido_materno"
                        [(ngModel)]="employee.apellido_materno" maxlength="30">
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.apellido_materno">
                            <div
                                *ngIf="employeeForm.get('apellido_materno').hasError(validation.type) &&
                              (employeeForm.get('apellido_materno').dirty || employeeForm.get('apellido_materno').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <label>{{strings.email}}<p>*</p></label>
                    <input type="email" id="correo" class="form-control" formControlName="correo"
                        [(ngModel)]="employee.correo" maxlength="50">
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.correo">
                            <div *ngIf="employeeForm.get('correo').hasError(validation.type) &&
                                (employeeForm.get('correo').dirty || employeeForm.get('correo').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div class="col">
                    <label>{{strings.phone}}<p>*</p></label>
                    <input type="tel" id="telefono" class="form-control" formControlName="telefono"
                        [(ngModel)]="employee.telefono" maxlength="10" (keypress)="onlyNumberKey($event)">
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.telefono">
                            <div *ngIf="employeeForm.get('telefono').hasError(validation.type) &&
                              (employeeForm.get('telefono').dirty || employeeForm.get('telefono').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <label>{{strings.new_password}}<p>*</p></label>
                    <input type="password" id="contrasena" class="form-control" formControlName="contrasena"
                        minlength="6">
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.contrasena">
                            <div *ngIf="employeeForm.get('contrasena').hasError(validation.type) &&
                              (employeeForm.get('contrasena').dirty || employeeForm.get('contrasena').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div class="col">
                    <label>{{strings.verific_password}}<p>*</p></label>
                    <input type="password" id="verificar_contrasena" class="form-control"
                        formControlName="verificar_contrasena" minlength="6">
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.verificar_contrasena">
                            <div
                                *ngIf="employeeForm.get('verificar_contrasena').hasError(validation.type) &&
                              (employeeForm.get('verificar_contrasena').dirty || employeeForm.get('verificar_contrasena').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
                <ngb-alert id="cuatro" type="danger" (close)="cerrar('cuatro')">{{strings.alert2}}</ngb-alert>
            </div>
            <div class="row">
                <div class="col">
                    <label>{{strings.sucursal}}<p>*</p></label>
                    <select id="id_sucursal" class="form-control custom-select" formControlName="id_sucursal">
                        <option *ngFor="let sucursal of sucursales" value="{{sucursal.id_sucursal}}">
                            {{sucursal.nombre}}
                        </option>
                    </select>
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.id_sucursal">
                            <div *ngIf="employeeForm.get('id_sucursal').hasError(validation.type) &&
                            (employeeForm.get('id_sucursal').dirty || employeeForm.get('id_sucursal').touched)">
                            {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div class="col">
                    <label>{{strings.role}}<p>*</p></label>
                    <select id="rol" class="form-control custom-select" formControlName="rol">
                        <option value="1" selected>
                            {{strings.employee}}
                        </option>
                        <option value="2">
                            {{strings.administrator}}
                        </option>
                    </select>
                    <div class="validation-error">
                        <ng-container *ngFor="let validation of validation_messages.rol">
                            <div *ngIf="employeeForm.get('rol').hasError(validation.type) &&
                            (employeeForm.get('rol').dirty || employeeForm.get('rol').touched)">
                                {{validation.message}}
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            <div class="boton">
                <button type="submit" id="editarEmpleado" class="btn btn-secondary"
                [disabled]="isDisable">
                    {{strings.send}}
                </button>
            </div>
        </form>
    </div>
    <div class="table">
        <div class="row" id="botones">
            <div class="col-xs-12 col-sm-12 col-md-5 col-lg-3 mt-5">
                <button id="search_all_employees" class="btn btn-outline-info btn-block" (click)="getEmployees()">
                    {{strings.show_all}}
                </button>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 mt-3">
                <div class="row">
                    <h5>{{strings.search}}</h5>
                    <input id="buscador" type="text" [(ngModel)]="busqueda" placeholder="Nombre o sucursal">
                    <button class="sear" id="search_employees" (click)="searchActive()" *ngIf="show === true">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="sear" id="search" (click)="searchDesactive()" *ngIf="show === false">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-5 col-lg-3 mt-5">
                <button id="true" class="btn btn-outline-warning btn-block" (click)="show = false"
                    *ngIf="show === true">
                    {{strings.react_employee}}
                </button>
                <button id="false" class="btn btn-outline-warning btn-block" (click)="show = true"
                    *ngIf="show === false">
                    {{strings.edit}}
                </button>
            </div>
        </div>
        <!-- tabla de empleados -->
        <div *ngIf="show === true;" class="tablas">
            <table>
                <thead>
                    <tr>
                        <th class="text-center">{{strings.employee}}</th>
                        <th class="text-center">{{strings.sucursal}}</th>
                        <th class="text-center">{{strings.name}}</th>
                        <th class="text-center">{{strings.surname}}</th>
                        <th class="text-center">{{strings.role}}</th>
                        <th class="text-center">{{strings.options}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="text-center" *ngFor="let e of activeEmployees">
                        <td>{{e.id_empleado}}</td>
                        <td>{{e.id_sucursal}}</td>
                        <td>{{e.nombre}}</td>
                        <td>{{e.apellido_paterno}} {{e.apellido_materno}}</td>
                        <td>{{e.rol}}</td>
                        <td class="text-center">
                            <button id="edit" class="btn btn-outline-success m-1" type="button"
                                (click)="getEmployee(e.id_empleado)">
                                <i class="fas fa-user-edit"></i>
                            </button>
                            <button id="delete" class="btn btn-outline-danger m-1" type="button"
                                (click)="desactiveEmployees(e.id_empleado, estado = 0)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- tabla empleados desactivados -->
        <div *ngIf="show === false" class="tablas">
            <table>
                <thead>
                    <tr>
                        <th class="text-center">{{strings.employee}}</th>
                        <th class="text-center">{{strings.sucursal}}</th>
                        <th class="text-center">{{strings.name}}</th>
                        <th class="text-center">{{strings.surname}}</th>
                        <th class="text-center">{{strings.role}}</th>
                        <th class="text-center">{{strings.recuve}}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="text-center" *ngFor="let d of deleteEmployees">
                        <td>{{d.id_empleado}}</td>
                        <td>{{d.id_sucursal}}</td>
                        <td>{{d.nombre}}</td>
                        <td>{{d.apellido_paterno}} {{d.apellido_materno}}</td>
                        <td>{{d.rol}}</td>
                        <td class="text-center">
                            <button id="botonReactivar" class="btn btn-outline-success m-1" type="button"
                                (click)="desactiveEmployees(d.id_empleado, estado = 1)">
                                <i class="fas fa-redo"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>